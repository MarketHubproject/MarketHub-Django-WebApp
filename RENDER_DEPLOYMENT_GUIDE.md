# MarketHub - Render Deployment Guide

## üöÄ Quick Deployment Steps

### 1. Prerequisites
- GitHub repository with your MarketHub code
- Render account (free tier available)
- Stripe account (for payment processing)

### 2. Deploy to Render
1. **Connect Repository**
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click "New +" ‚Üí "Blueprint"
   - Connect your GitHub repository
   - Select the MarketHub-Django-WebApp repository

2. **Blueprint Deployment**
   - Render will automatically detect the `render.yaml` file
   - Click "Apply" to create all services:
     - Web service (Django app)
     - PostgreSQL database
     - Redis cache

3. **Set Environment Variables**
   - See the detailed list below

## üîß Required Environment Variables

Set these in your Render service dashboard under "Environment":

### Core Django Settings
```bash
# Security (automatically generated by Render)
SECRET_KEY=your-secret-key-here

# Debug and Host Configuration
DEBUG=False
ALLOWED_HOSTS=.onrender.com,yourdomain.com
SITE_URL=https://your-app-name.onrender.com

# Django Settings Module
DJANGO_SETTINGS_MODULE=markethub.settings_production
```

### Database Configuration
```bash
# Automatically set by Render when using Blueprint
DATABASE_URL=postgresql://user:pass@host:port/dbname
```

### Static Files
```bash
STATIC_URL=/static/
STATIC_ROOT=./staticfiles
```

### Payment Processing (Stripe)
```bash
# Get these from your Stripe Dashboard
STRIPE_PUBLISHABLE_KEY=pk_test_... (or pk_live_...)
STRIPE_SECRET_KEY=sk_test_... (or sk_live_...)
STRIPE_WEBHOOK_SECRET=whsec_...
PAYMENT_ENV=test  # or 'live' for production
```

### Email Configuration (Optional)
```bash
# For production email sending
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-app-password
```

### Cache Configuration
```bash
# Automatically set by Render Redis service
REDIS_URL=redis://red-xxxxx:6379
```

### Logging
```bash
DJANGO_LOG_LEVEL=INFO  # or DEBUG for verbose logging
```

## üèóÔ∏è Service Configuration

Your `render.yaml` creates these services:

### 1. Web Service
- **Name**: `markethub-web`
- **Type**: Web Service
- **Plan**: Free (upgradeable)
- **Build Command**: `./build.sh`
- **Start Command**: `gunicorn markethub.wsgi:application`
- **Health Check**: `/health/`

### 2. PostgreSQL Database
- **Name**: `markethub-db`
- **Type**: PostgreSQL
- **Plan**: Free (upgradeable)
- **Database**: `markethub`
- **User**: `markethub_user`

### 3. Redis Cache
- **Name**: `markethub-redis`
- **Type**: Redis
- **Plan**: Free (upgradeable)

## üìã Post-Deployment Checklist

### 1. Verify Deployment
- [ ] Web service shows "Live" status
- [ ] Database is connected and healthy
- [ ] Redis cache is running
- [ ] Health check endpoint returns 200 OK

### 2. Access Your App
- Visit your app URL: `https://your-app-name.onrender.com`
- Admin panel: `https://your-app-name.onrender.com/admin/`
- API docs: `https://your-app-name.onrender.com/docs/`

### 3. Create Admin User
The build script creates a default admin user:
- **Username**: `admin`
- **Password**: `changeme123`
- **‚ö†Ô∏è IMPORTANT**: Change this password immediately!

### 4. Configure Stripe Webhooks
1. Go to Stripe Dashboard ‚Üí Webhooks
2. Add endpoint: `https://your-app-name.onrender.com/stripe/webhook/`
3. Select events you need (e.g., `payment_intent.succeeded`)
4. Copy webhook secret to `STRIPE_WEBHOOK_SECRET` env var

## üîí Security Best Practices

### 1. Change Default Credentials
```bash
# Access your app and go to /admin/
# Change the admin password immediately
```

### 2. Environment Variables Security
- Never commit secrets to Git
- Use Render's environment variable encryption
- Rotate secrets regularly

### 3. Database Security
- Use strong PostgreSQL passwords (handled by Render)
- Regular database backups
- Monitor database access logs

## üö® Troubleshooting

### Common Issues

#### 1. Build Failures
```bash
# Check build logs in Render dashboard
# Common fixes:
- Ensure requirements.txt is up to date
- Check Python version in runtime.txt
- Verify build.sh has correct permissions
```

#### 2. Database Connection Issues
```bash
# Verify DATABASE_URL is correctly set
# Check PostgreSQL service status
# Ensure migrations are applied
```

#### 3. Static Files Not Loading
```bash
# Verify STATIC_URL and STATIC_ROOT settings
# Check Whitenoise configuration
# Ensure collectstatic runs in build.sh
```

#### 4. 500 Internal Server Error
```bash
# Check application logs in Render dashboard
# Verify all environment variables are set
# Check Django settings configuration
```

### Debug Commands
```bash
# Access your service shell via Render dashboard
python manage.py check
python manage.py migrate --list
python manage.py collectstatic --dry-run
```

## üìà Scaling & Performance

### Free Tier Limitations
- Web service sleeps after 15 minutes of inactivity
- 512MB RAM, shared CPU
- 1GB PostgreSQL storage
- 25MB Redis memory

### Upgrade Options
- **Starter Plan**: $7/month - No sleep, dedicated resources
- **Standard Plan**: $25/month - More resources, better performance
- **Pro Plan**: $85/month - High performance, advanced features

## üîÑ Continuous Deployment

### Automatic Deployments
Render automatically deploys when you push to your main branch:

1. **Push to GitHub**
   ```bash
   git add .
   git commit -m "Update application"
   git push origin main
   ```

2. **Render Auto-Deploy**
   - Detects changes in GitHub
   - Runs build script
   - Deploys new version
   - Health check validation

### Manual Deployment
- Use "Manual Deploy" button in Render dashboard
- Deploy specific commits or branches
- Rollback to previous deployments

## üìä Monitoring & Logs

### Application Logs
- Access via Render dashboard
- Real-time log streaming
- Download log files

### Health Monitoring
- Built-in health checks at `/health/`
- Uptime monitoring
- Performance metrics

### Database Monitoring
- Connection pool status
- Query performance
- Storage usage

## üõ†Ô∏è Maintenance

### Regular Tasks
- [ ] Monitor application logs
- [ ] Check database performance
- [ ] Update dependencies monthly
- [ ] Review security settings
- [ ] Backup database regularly

### Updates
```bash
# Update Python dependencies
pip list --outdated
pip install -r requirements.txt --upgrade

# Update Node dependencies (if using)
npm outdated
npm update
```

## üìû Support

### Resources
- [Render Documentation](https://render.com/docs)
- [Django Deployment Guide](https://docs.djangoproject.com/en/stable/howto/deployment/)
- [Stripe Documentation](https://stripe.com/docs)

### Getting Help
1. Check Render status page
2. Review application logs
3. Check Django settings
4. Contact Render support (for platform issues)

---

## üéâ Success!

If you've followed this guide, your MarketHub Django application should now be running on Render with:

‚úÖ **Secure HTTPS deployment**  
‚úÖ **PostgreSQL database**  
‚úÖ **Redis caching**  
‚úÖ **Automatic deployments**  
‚úÖ **Health monitoring**  
‚úÖ **Payment processing ready**  

Your MarketHub e-commerce platform is now live and ready for customers! üõçÔ∏è